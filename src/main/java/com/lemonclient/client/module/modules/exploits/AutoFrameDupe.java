package com.lemonclient.client.module.modules.exploits;

import com.lemonclient.api.setting.values.BooleanSetting;
import com.lemonclient.api.setting.values.IntegerSetting;
import com.lemonclient.client.module.Category;
import com.lemonclient.client.module.Module;
import java.util.Iterator;
import net.minecraft.entity.Entity;
import net.minecraft.entity.item.EntityItemFrame;
import net.minecraft.init.Items;
import net.minecraft.item.ItemShulkerBox;
import net.minecraft.util.EnumHand;

@Module.Declaration(
   name = "6bDupe",
   category = Category.Exploits
)
public class AutoFrameDupe extends Module {
   BooleanSetting shulkersonly = this.registerBoolean("Shulkers Only", true);
   IntegerSetting range = this.registerInteger("Range", 5, 0, 6);
   IntegerSetting turns = this.registerInteger("Turns", 1, 0, 3);
   IntegerSetting ticks = this.registerInteger("Ticks", 10, 1, 20);
   private int timeout_ticks;

   private int getShulkerSlot() {
      int n = -1;

      for(int i = 0; i < 9; ++i) {
         if (mc.field_71439_g.field_71071_by.func_70301_a(i).func_77973_b() instanceof ItemShulkerBox) {
            n = i;
         }
      }

      return n;
   }

   public void onUpdate() {
      if (mc.field_71439_g != null && mc.field_71441_e != null) {
         if ((Boolean)this.shulkersonly.getValue()) {
            int shulkerSlot = this.getShulkerSlot();
            if (shulkerSlot != -1) {
               mc.field_71439_g.field_71071_by.field_70461_c = shulkerSlot;
            }
         }

         Iterator var4 = mc.field_71441_e.field_72996_f.iterator();

         while(true) {
            Entity entity;
            do {
               do {
                  if (!var4.hasNext()) {
                     return;
                  }

                  entity = (Entity)var4.next();
               } while(!(entity instanceof EntityItemFrame));
            } while(!(mc.field_71439_g.func_70032_d(entity) <= (float)(Integer)this.range.getValue()));

            if (this.timeout_ticks >= (Integer)this.ticks.getValue()) {
               if (((EntityItemFrame)entity).func_82335_i().func_77973_b() == Items.field_190931_a && !mc.field_71439_g.func_184614_ca().field_190928_g) {
                  mc.field_71442_b.func_187097_a(mc.field_71439_g, entity, EnumHand.MAIN_HAND);
               }

               if (((EntityItemFrame)entity).func_82335_i().func_77973_b() != Items.field_190931_a) {
                  for(int i = 0; i < (Integer)this.turns.getValue(); ++i) {
                     mc.field_71442_b.func_187097_a(mc.field_71439_g, entity, EnumHand.MAIN_HAND);
                  }

                  mc.field_71442_b.func_78764_a(mc.field_71439_g, entity);
                  this.timeout_ticks = 0;
               }
            }

            ++this.timeout_ticks;
         }
      }
   }
}
